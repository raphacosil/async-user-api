<div class="page-header">
  <h1>✏️ Editando: {{user.name}}</h1>
  <div class="header-actions">
    <a href="/users/{{user.id}}" class="btn btn-info">👁️ Ver Detalhes</a>
    <a href="/" class="btn btn-secondary">⬅️ Voltar para Lista</a>
  </div>
</div>

<!-- Formulário de Edição do Usuário -->
<div class="edit-container">
  <section class="user-edit-section">
    <h2>👤 Dados do Usuário</h2>
  
    <form action="/users/update" method="POST" class="form">
      <input type="hidden" name="id" value="{{user.id}}" />
    
      <div class="form-group">
        <label for="name">Nome Completo *</label>
        <input 
          type="text" 
          id="name"
          name="name" 
          class="form-control"
          placeholder="Digite o nome completo"
          value="{{user.name}}"
          required
          minlength="2"
          maxlength="100"
        />
      </div>

      <div class="form-group">
        <label for="occupation">Profissão</label>
        <input 
          type="text" 
          id="occupation"
          name="occupation" 
          class="form-control"
          placeholder="Digite a profissão"
          value="{{user.occupation}}"
          maxlength="150"
        />
      </div>

      <div class="form-group">
        <div class="form-checkbox">
          <input 
            type="checkbox" 
            id="newsletter"
            name="newsletter" 
            {{#if user.newsletter}}checked{{/if}}
          />
          <label for="newsletter">📧 Receber newsletter</label>
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn btn-primary">💾 Salvar Alterações</button>
      </div>
    </form>
  </section>

  <!-- Seção de Endereços -->
  <section class="addresses-section">
    <h2>🏠 Gerenciar Endereços</h2>
  
    <!-- Formulário para Adicionar Novo Endereço -->
    <div class="address-form-container">
      <h3>➕ Adicionar Novo Endereço</h3>
    
      <form action="/address/create" method="POST" class="address-form">
        <input type="hidden" name="userId" value="{{user.id}}" />
      
        <div class="form-row">
          <div class="form-group">
            <label for="street">Rua/Avenida *</label>
            <input 
              type="text" 
              id="street"
              name="street" 
              class="form-control"
              placeholder="Digite o nome da rua"
              required
              minlength="5"
              maxlength="200"
            />
          </div>
        
          <div class="form-group">
            <label for="number">Número</label>
            <input 
              type="text" 
              id="number"
              name="number" 
              class="form-control"
              placeholder="Número"
              maxlength="20"
            />
          </div>
        </div>
      
        <div class="form-group">
          <label for="city">Cidade *</label>
          <input 
            type="text" 
            id="city"
            name="city" 
            class="form-control"
            placeholder="Digite a cidade"
            required
            minlength="2"
            maxlength="100"
          />
        </div>
      
        <button type="submit" class="btn btn-primary">🏠 Adicionar Endereço</button>
      </form>
    </div>

    <!-- Lista de Endereços Existentes -->
    <div class="addresses-list-container">
      <h3>📋 Endereços Cadastrados ({{user.addresses.length}})</h3>
    
      {{#if user.addresses.length}}
      <div class="addresses-list">
        {{#each user.addresses}}
        <div class="address-item">
          <div class="address-info">
            <strong>📍 {{this.street}}</strong>
            {{#if this.number}}, nº {{this.number}}{{/if}}
            <br>
            <span class="city">🏘️ {{this.city}}</span>
            <small class="address-meta">ID: #{{this.id}}</small>
          </div>
        
          <div class="address-actions">
            <form action="/address/delete" method="POST" class="delete-form">
              <input type="hidden" name="id" value="{{this.id}}" />
              <input type="hidden" name="userId" value="{{../user.id}}" />
              <button 
                type="submit" 
                class="btn btn-danger btn-sm"
                onclick="return confirm('⚠️ Tem certeza que deseja excluir este endereço?')"
              >
                🗑️ Excluir
              </button>
            </form>
          </div>
        </div>
        {{/each}}
      </div>
      {{else}}
      <div class="empty-addresses">
        <p>📭 Nenhum endereço cadastrado ainda</p>
        <p>Use o formulário acima para adicionar o primeiro endereço.</p>
      </div>
      {{/if}}
    </div>
  </section>
</div>

<style>
.edit-container {
  display: grid;
  gap: 2rem;
}

.user-edit-section,
.addresses-section {
  background: white;
  padding: 2rem;
  border-radius: 10px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

.user-edit-section h2,
.addresses-section h2 {
  color: #495057;
  margin-bottom: 1.5rem;
  padding-bottom: 0.5rem;
  border-bottom: 2px solid #e9ecef;
}

.addresses-section h3 {
  color: #6c757d;
  margin-bottom: 1rem;
  font-size: 1.2rem;
}

.address-form-container {
  background: #f8f9fa;
  padding: 1.5rem;
  border-radius: 8px;
  margin-bottom: 2rem;
}

.form-row {
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 1rem;
}

.addresses-list {
  display: grid;
  gap: 1rem;
}

.address-item {
  background: #f8f9fa;
  padding: 1.5rem;
  border-radius: 8px;
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  border-left: 4px solid #667eea;
}

.address-info strong {
  color: #495057;
  display: block;
  margin-bottom: 0.5rem;
}

.city {
  color: #6c757d;
  font-style: italic;
}

.address-meta {
  color: #adb5bd;
  font-size: 0.8rem;
  display: block;
  margin-top: 0.5rem;
}

.btn-sm {
  padding: 0.4rem 0.8rem;
  font-size: 0.875rem;
}

.empty-addresses {
  text-align: center;
  padding: 3rem;
  color: #6c757d;
  background: #f8f9fa;
  border-radius: 8px;
  border: 2px dashed #dee2e6;
}

.form-actions {
  text-align: center;
  margin-top: 1.5rem;
}

.header-actions {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
}

/* Responsividade */
@media (max-width: 768px) {
  .form-row {
    grid-template-columns: 1fr;
  }
  
  .address-item {
    flex-direction: column;
    gap: 1rem;
  }
  
  .header-actions {
    flex-direction: column;
  }
  
  .addresses-list-container h3 {
    text-align: center;
  }
}

/* Animações */
.address-item {
  transition: transform 0.2s, box-shadow 0.2s;
}

.address-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

/* Melhorias visuais */
.address-form {
  border: 2px dashed #dee2e6;
  border-radius: 8px;
  padding: 1rem;
  background: white;
}

.address-form:focus-within {
  border-color: #667eea;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}
</style>